name: build

on:
  push:
    branches:
      - master

  pull_request:
    branches:
      - master

jobs:
  build:

    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2

    - name: Make build lint and test
      id: make
      run: |
        make

    - name: Notify
      run: |
        curl '${{ secrets.WECHATWORK_WEBHOOK }}' \
           -H 'Content-Type: application/json' \
           -d '
           {
                "msgtype": "markdown",
                "markdown": {
                    "content": "
        <font color=\"info\">${{ github.repository }} ${{ github.workflow }} finished</font>ï¼š
        >status:  <font color=\"comment\">${{ job.status }}</font>
        >committer: <font color=\"comment\">${{ github.actor }}</font>
                        "
                }
           }'